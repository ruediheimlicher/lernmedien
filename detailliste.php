<?/*Datenbank Lernmedien*//* verbinden mit db */		$db = mysql_connect("localhost","ruediheimlicher","RivChuv4");	/* nun ist der zugang zum db-server in der variable $db gespeichert */	mysql_set_charset('utf8',$db);	/* hier wird nun die eigentliche db ausgewählt */	mysql_select_db("ruediheimlicher_lernmedien", $db); ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="de"><head>  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lernmedien Detail</title> <link href="lernmedien.css" rel="stylesheet" type="text/css" /></head><body class="lernmedien">	<?$task="";if (isset($_POST['task'])){	$task = $_POST['task'];	}#print 'task: '.$task.'<br>';if (isset($_POST['quelle'])){	$quelle = $_POST['quelle'];	}#print 'quelle: '.$quelle.'<br>';#print '<br>';$speicherid = $_POST['speicherid'];	#print 'speicherid count: '.count($speicherid).'<br>';#print 'speicherid:<br>';#print_r($speicherid);#print '<br>';$speicheranzahl = $_POST['speicheranzahl'];	#print 'speicheranzahl: '.$speicheranzahl.'<br>';#print_r($speicheranzahl);#print '<br>';$speichername = $_POST['speichername'];	#print 'speichername: "'.$speichername.'"<br>';#print_r($speichername);#print '<br>';if (isset($_POST['auswahlgruppe'])){	$speicherauswahlgruppe = $_POST['auswahlgruppe'];}#print 'speicherauswahlgruppe: '.$speicherauswahlgruppe.'<br>';$anzahldaten = $_POST['anzahldaten'];	#print 'anzahldaten: '.$anzahldaten.'<br>';for($i=0;$i<count($speicherid);$i++){	#print 'speicherid: '.$speicherid[$i].' speichername: '.$speichername[$i].' speicheranzahl: '.$speicheranzahl[$i].'<br>';}$auswahlgruppe = $_POST['gruppe'];#print 'Gruppe: '.$auswahlgruppe;$auswahlgruppeklein=strtolower($auswahlgruppe);#print ' Gruppe klein: '.$auswahlgruppeklein;$result_gruppe = mysql_query("SELECT  FROM lernmedien WHERE gruppe=$auswahlgruppeklein");$titelstring= 'Lernmedien '.$auswahlgruppe;?>	<div class="detailtitelabschnitt">	<?	print'<h1 class="lernmedien Detail">'.$titelstring.'</h1>';	?></div><div class="detailmenuabschnitt">		<table class="menutabelle">	<!--	<tr><td class="lernmedientabellentext "><a href="liste.php">Liste</a></td></tr>	<tr><td class="lernmedientabellentext "><a href="benutzerauswahl.php">Bestellung</a></td></tr>	-->	<tr><td class="lernmedientabellentext "><a href="index.php">Start</a></td></tr>	</table>	</div>					<div class="detailabschnitt1">		<div class="gruppentabelle">	<?		function string4web($string)	{   	 return strtolower(preg_replace('/\W+/', '_', $string));	}  		function leerschlagweg($string)	{		$newstring=preg_replace('/ /', '_',$string);		return $newstring;	}			function umlautweg($string)	{		# $ccc = hash{"ä"=>"ae", "ö"=>"oe", "ü"=>"ue", "Ä"=>"Ae", "Ö"=>"Oe", "Ü"=>"Ue"};		#s/([äüöÄÜÖ]/$ccc{$1}/g;		#$newstring =~ s/([äüöÄÜÖ]/$ccc{$1}/g;		$newstring=preg_replace('/ä/', 'ae',$string);		$newstring=preg_replace('/ö/', 'oe',$newstring);		$newstring=preg_replace('/ü/', 'ue',$newstring);		return $newstring;	}			#$gruppenarray = mysql_fetch_array($result_gruppe) ;			$adressestring = '<h1 class="lernmedien">Adresse</h1>';	$adressestring .= '<form action="/cgi-bin/lernmedienbestellung.pl" method="post">';	$adressestring .= '<p>Name:<br><input size="40" maxlength="40" name="AnwenderName"></p>';	$adressestring .= '<p>Text:<br><textarea rows="5" cols="50" name="Kommentartext"></textarea></p>';	$adressestring .= '<p><input type="submit" value="Absenden"></p>';	$adressestring .= '</form>';		#$db->set_charset("utf8"); 	/* sql-abfrage schicken */			$result_medien = mysql_query("SELECT * FROM lernmedien", $db);		/* resultat in einer schleife auslesen */		/* Kontrolle	print '<table width="759" border="1">';	print '<table margin-bottom="20px">';	print '<tr >';		while ($medien = mysql_fetch_array($result_medien) )	{		$x=$medien['name'];		print '<p>Das ist ein Eintrag. Er ist: '. $x.' Punkt</p>';	}	*/	#$index=0;		#mysql_data_seek($result_medien,$index);		# zu benutzerauswahl	print '<form action="benutzerauswahl.php" method="post">';	print '<table class="lernmedientabelle">';	print '<tr >';	$zeile=0;	$eingabe=array();	while ($medien = mysql_fetch_array($result_medien) )	{		#print $medien['gruppe'];		if ($medien['gruppe']==$auswahlgruppe)				{			print '	<tr>';			# Bilder laden					#$bildlink = "Bilder/".$ordnernummer."/".$ordnernummer."0010".".jpg";			$webname=$medien['name'];			#print 'webname vor: '.$webname;			$webname=leerschlagweg($webname);			#print 'webname nach leerschlagweg: '.$webname;			$webname=umlautweg($webname);			#print 'webname nach umlautweg: '.$webname.'<br>';			$ordnerpfad='Bilder/Gruppen/'.$auswahlgruppe.'/'.$webname;					#print 'ordnerpfad: '.$ordnerpfad.'<br>';			if (is_dir($ordnerpfad))			{				$ordnerhandle=@opendir($ordnerpfad); # @ unterdrückt warnung bei nicht vorhandenem Ordner				$orderinhalt = array();						while ($datei = readdir ($ordnerhandle)) 				{		 					 			if (!($datei[0]==".") && is_dir($ordnerpfad.'/'.$datei))		 			{						print $datei.'<br>';		 				$orderinhalt[]=$datei;		 			}				}						closedir($ordnerhandle);					}# if isdir					print '<td class="lernmedientabellentext oben ">' . '<strong>'.$medien['name'] . '</strong><br>';			print 'id: '.$medien['id'] . '<br>';			print $medien['beschreibung'] . '<br>';			print 'Art: '.$medien['art'] . '<br>';			print 'Stufe: '.$medien['stufe'] . '<br>';			print '<strong>Preis: ' . $medien['preis'] . '</strong><br>';			print '<a href=detailanzeige.php'.'?ordnerpfad='.$ordnerpfad.' target="_blank">Details</a>' . '<br>';			#	print '<br><form action="http://web.me.com/ruedi.heimlicher/Website/Lernmedien.html" ><p 			# beginn Eingabe Reproduzieren bei Rückkehr von benutzerauswahl						# Bei der Rückkehr vom Bestellformular feststellen, ob die Zeile in der Bestellung vorhanden war und an welcher Position im Array $speicherid			$pos=0;			if ($task == "bestellung" && in_array($medien['id'], $speicherid))			{				for ($k=0;$k<count($speicherid);$k++)				{					if ($medien['id'] == $speicherid[$k])					{						$pos = $k;					}					} # for $k				print 'pos: '.$pos.'<br>';				# wenn gefunden: Anzahl einsetzen				print 'Bestellen: '.'<input type = "text" name= "eingabe[]" value ="'.$speicheranzahl[$pos].'"  size="1" maxlength="2"></td>';					}			else			{				# sonst: leeres Eingabefeld				print 'Bestellen: '.'<input type = "text" name= "eingabe[]" unten size="1" maxlength="2"></td>';			}			# ende Eingabe Reproduzieren bei Rückkehr von benutzerauswahl			#print 'Bestellen: '.'<input type = "text" name= "eingabe[]" unten size="1" maxlength="2"></td>';											$ordnernummer=sprintf("%03d",$medien['id']);			$bildnummer=$ordnernummer."0010";			$bildlink = "Bilder/Gruppen/".$auswahlgruppe."/".$webname."/000".".jpg";			#print 'bildlink: '.$bildlink.'<br>';						print '<td class="lernmedientabellenbild breite200 "><img class="mediumfoto " src='. $bildlink .' alt="kein Bild" /></td>';					# Informationen für post			print '<input type="hidden" name=index[] value ='.$medien['id'].'>';			print '<input type="hidden" name=name[] value ="'.$medien['name'].'">';			print '<input type="hidden" name=preis[] value ='.$medien['preis'].'>';					print '	</tr>';			print '<input type="hidden" name=quelle value ="detail">';				} # if gruppe		else		{			# 6.2.12 Notwendig, um Reihenfolge zu sichern. 			# Entspricht in 'liste' einem leeren Eingabefled			print '<input type="hidden" name=eingabe[] value ="">';		}		$zeile++;	}	print '</table>';		print '<input type="hidden" name=auswahlgruppe value ='.$auswahlgruppe.'>';	#print '<input type="hidden" name=index[] value ='.$medien['id'].'>';	print '<br><p class="liste" ><input type="submit" name="Bestellung" value="zur Bestellung"></p></form>';	#zurueck	#print '<form action="lernmedien.php" ><input type="submit" value="zurück" name="textfile"></form>';	// probeweise	#print $adressestring;		/*perlscript aufrufen*/	$index=0;	mysql_data_seek($result_medien,$index);	$zeile= mysql_fetch_assoc($result_medien);	#print "<p>Ausgabe Zeile:</p>";	#print '<p>*name: *'.$zeile['name'].'* art: *'.$zeile['art'].'* PREIS: *'.$zeile['preis'].'*</p>';	#print '<br><form action="http://web.me.com/ruedi.heimlicher/Website/Lernmedien.html" ><p class="liste"><input type="submit" value="zurück" name="textfile"></p></form>';		?>	</div></div><?php# $para1 = "dies ist ein string";# $para2 = 42; # $pstring = sprintf("para1=%s&amp;para2=%s",#		urlencode($para1),#		urlencode($para2));?><!--<a href="benutzerauswahl.php?<?php print $pstring ?>">go</a> --><!--<p><a href="benutzerauswahl.php">senden</a></p>--><!--<div class="abschnitt2"><br><form action="http://web.me.com/ruedi.heimlicher/Website/Lernmedien.html" ><p class="liste"><input type="submit" value="zurück" name="textfile"></p></form>	<br><p class="liste">Verantwortlich f&uuml;r den Inhalt dieser Seiten ist:<br>	<a href="mailto:rosmarie.egli@bluewin.ch">Rosmarie Egli</a>	</p></div>--><br><br>	<p>	<?		?>	<?		?>	</p></body></html>